{% extends 'base.html' %}

{% block title %}Financeiro - Dr. Pulse{% endblock %}

{% block extra_css %}
<style>
body {
    background-color: #f8f9fc;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
}

.financial-container {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    margin: 1rem;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.financial-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #e9ecef;
}

.financial-title {
    font-size: 1.8rem;
    font-weight: 600;
    color: #2d3748;
    margin: 0;
}

.summary-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.summary-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 1.5rem;
    border-radius: 12px;
    text-align: center;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.summary-card.green {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
}

.summary-card.blue {
    background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
}

.summary-card.orange {
    background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
}

.summary-value {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
}

.summary-label {
    font-size: 0.9rem;
    opacity: 0.9;
    font-weight: 500;
}

.chart-section {
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.chart-container {
    position: relative;
    height: 300px;
    width: 100%;
}

.chart-canvas {
    max-height: 300px !important;
    max-width: 100% !important;
}

.transactions-section {
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.transactions-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #e9ecef;
}

.transactions-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: #2d3748;
    margin: 0;
}

.filter-tabs {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
}

.filter-tab {
    padding: 0.5rem 1rem;
    border-radius: 20px;
    border: none;
    background: #f7fafc;
    color: #4a5568;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
}

.filter-tab.active {
    background: #667eea;
    color: white;
}

.filter-tab:hover {
    background: #e2e8f0;
}

.filter-tab.active:hover {
    background: #5a67d8;
}

.transactions-table {
    width: 100%;
    border-collapse: collapse;
}

.transactions-table th {
    text-align: left;
    padding: 0.75rem;
    font-weight: 600;
    color: #4a5568;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-bottom: 1px solid #e2e8f0;
}

.transactions-table td {
    padding: 1rem 0.75rem;
    border-bottom: 1px solid #f7fafc;
    vertical-align: middle;
}

.transaction-row:hover {
    background-color: #f7fafc;
}

.transaction-date {
    font-weight: 600;
    color: #2d3748;
}

.transaction-description {
    font-weight: 500;
    color: #2d3748;
    margin-bottom: 0.25rem;
}

.transaction-category {
    font-size: 0.8rem;
    color: #718096;
}

.transaction-value {
    font-weight: 700;
    font-size: 1.1rem;
}

.transaction-value.positive {
    color: #38a169;
}

.transaction-value.negative {
    color: #e53e3e;
}

.status-badge {
    padding: 0.25rem 0.75rem;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.status-badge.recorrente {
    background: #667eea;
    color: white;
}

.status-badge.pago {
    background: #48bb78;
    color: white;
}

.status-badge.pendente {
    background: #ed8936;
    color: white;
}

.payment-type {
    font-size: 0.8rem;
    color: #718096;
}

.btn-new-transaction {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-new-transaction:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

.summary-bottom {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid #e2e8f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 600;
}

.total-recebido {
    color: #38a169;
    font-size: 1.1rem;
}

.total-a-receber {
    color: #718096;
    font-size: 1.1rem;
}

/* GRÁFICO FORÇADO - NÃO PODE SER SOBRESCRITO */
.forced-chart-container {
    background: white !important;
    padding: 30px !important;
    border-radius: 12px !important;
    margin: 20px 0 !important;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1) !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    height: auto !important;
    min-height: 250px !important;
}

.ultra-simple-chart {
    display: flex !important;
    justify-content: space-around !important;
    align-items: end !important;
    height: 180px !important;
    padding: 20px !important;
    background: #f8f9fc !important;
    border-radius: 8px !important;
    margin: 20px 0 !important;
}

.chart-item {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    text-align: center !important;
}

.chart-bar {
    width: 50px !important;
    border-radius: 4px 4px 0 0 !important;
    margin-bottom: 10px !important;
    display: block !important;
}

.receitas-bar {
    height: 120px !important;
    background: linear-gradient(to top, #38a169, #68d391) !important;
}

.despesas-bar {
    height: 80px !important;
    background: linear-gradient(to top, #e53e3e, #fc8181) !important;
}

.lucro-bar {
    height: 100px !important;
    background: linear-gradient(to top, #667eea, #764ba2) !important;
}

.chart-label {
    color: #4a5568 !important;
    font-size: 0.85rem !important;
    font-weight: 500 !important;
    line-height: 1.3 !important;
}

.chart-label strong {
    color: #2d3748 !important;
    font-weight: 700 !important;
    font-size: 0.9rem !important;
}

.chart-summary {
    display: flex !important;
    justify-content: space-around !important;
    padding: 20px !important;
    background: #f7fafc !important;
    border-radius: 8px !important;
    margin-top: 20px !important;
}

.summary-item {
    text-align: center !important;
}

.summary-label {
    color: #718096 !important;
    font-size: 0.9rem !important;
    display: block !important;
    margin-bottom: 5px !important;
}

.summary-value {
    font-weight: 700 !important;
    font-size: 1.2rem !important;
}

.summary-value.success {
    color: #38a169 !important;
}

.summary-value.info {
    color: #667eea !important;
}

.metric-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1rem;
    font-size: 1.5rem;
}

.income-icon { background: linear-gradient(135deg, #28a745, #20c997); color: white; }
.received-icon { background: linear-gradient(135deg, #17a2b8, #6f42c1); color: white; }
.pending-icon { background: linear-gradient(135deg, #ffc107, #fd7e14); color: white; }
.overdue-icon { background: linear-gradient(135deg, #dc3545, #e83e8c); color: white; }

.transactions-header {
    display: flex;
    justify-content: between;
    align-items: center;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid #f8f9fa;
}

.btn-modern {
    border-radius: 25px;
    padding: 0.5rem 1.5rem;
    font-weight: 600;
    border: none;
    transition: all 0.3s ease;
}

.btn-primary-modern {
    background: linear-gradient(135deg, #8e44ad, #bb8fce);
    color: white;
}

.btn-primary-modern:hover {
    background: linear-gradient(135deg, #7d3c98, #a569bd);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(142, 68, 173, 0.4);
}

.table-modern {
    border-collapse: separate;
    border-spacing: 0;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
}

.table-modern thead th {
    background: linear-gradient(135deg, #8e44ad, #bb8fce);
    color: white;
    font-weight: 600;
    border: none;
    padding: 1rem;
    text-transform: uppercase;
    font-size: 0.8rem;
    letter-spacing: 0.5px;
}

.table-modern tbody tr {
    transition: all 0.3s ease;
}

.table-modern tbody tr:hover {
    background: #f8f9fa;
    transform: scale(1.01);
}

.table-modern tbody td {
    padding: 1rem;
    border: none;
    border-bottom: 1px solid #f8f9fa;
}

.status-badge {
    padding: 0.4rem 1rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.status-paid { background: #d4edda; color: #155724; }
.status-pending { background: #fff3cd; color: #856404; }
.status-overdue { background: #f8d7da; color: #721c24; }

.summary-section {
    background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
    border-radius: 15px;
    padding: 1.5rem;
    margin-bottom: 1rem;
}

.progress-modern {
    height: 8px;
    border-radius: 10px;
    background: #f8f9fa;
    overflow: hidden;
}

.progress-bar-modern {
    border-radius: 10px;
    transition: width 0.6s ease;
}
</style>
{% endblock %}

{% block content %}
<div class="financial-container">
    <!-- Header -->
    <div class="financial-header">
        <h1 class="financial-title">Transações</h1>
        <button class="btn-new-transaction">
            + Nova transação
        </button>
    </div>

    <!-- Cards de Resumo -->
    <div class="summary-cards">
        <div class="summary-card">
            <div class="summary-value">R$17.672,74</div>
            <div class="summary-label">Resultado previsto no mês</div>
        </div>
        <div class="summary-card green">
            <div class="summary-value">R$58.074,49</div>
            <div class="summary-label">Recebido - 100%</div>
        </div>
        <div class="summary-card blue">
            <div class="summary-value">R$40.401,75</div>
            <div class="summary-label">Previsto - 80,30%</div>
        </div>
        <div class="summary-card orange">
            <div class="summary-value">R$81.371,85</div>
            <div class="summary-label">Saldo atual</div>
        </div>
    </div>

    <!-- Gráfico -->
    <div class="chart-section">
        <h3 style="text-align: center; margin-bottom: 1rem; color: #2d3748;">
            <i class="fas fa-chart-line me-2"></i>Receitas vs Despesas
        </h3>
        
        <!-- GRÁFICO FORÇADO COM !important -->
        <div class="forced-chart-container">
            <h4 style="text-align: center !important; color: #2d3748 !important; margin-bottom: 20px !important;">
                📊 Resumo Financeiro
            </h4>
            
            <!-- Gráfico Ultra Simples -->
            <div class="ultra-simple-chart">
                <!-- Receitas -->
                <div class="chart-item receitas">
                    <div class="chart-bar receitas-bar"></div>
                    <div class="chart-label">Receitas<br><strong>R$ 58.074</strong></div>
                </div>
                
                <!-- Despesas -->
                <div class="chart-item despesas">
                    <div class="chart-bar despesas-bar"></div>
                    <div class="chart-label">Despesas<br><strong>R$ 32.441</strong></div>
                </div>
                
                <!-- Lucro -->
                <div class="chart-item lucro">
                    <div class="chart-bar lucro-bar"></div>
                    <div class="chart-label">Lucro<br><strong>R$ 25.633</strong></div>
                </div>
            </div>
            
            <!-- Resumo -->
            <div class="chart-summary">
                <div class="summary-item">
                    <span class="summary-label">Taxa de Lucro:</span>
                    <span class="summary-value success">44.2%</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Crescimento:</span>
                    <span class="summary-value info">+15.8%</span>
                </div>
            </div>
        </div>
        
        <!-- Legenda estilo Procfy -->
        <div style="display: flex; justify-content: center; gap: 30px; margin-top: 15px;">
            <div style="display: flex; align-items: center; gap: 8px;">
                <div style="width: 20px; height: 8px; background: linear-gradient(135deg, #38a169, #48bb78); border-radius: 4px;"></div>
                <span style="font-size: 0.9rem; color: #4a5568; font-weight: 500;">Recebimentos</span>
                <span style="font-size: 0.8rem; color: #38a169; font-weight: 600;">100,00%</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
                <div style="width: 20px; height: 8px; background: linear-gradient(135deg, #e53e3e, #fc8181); border-radius: 4px;"></div>
                <span style="font-size: 0.9rem; color: #4a5568; font-weight: 500;">Despesas</span>
                <span style="font-size: 0.8rem; color: #e53e3e; font-weight: 600;">80,30%</span>
            </div>
        </div>
    </div>

    <!-- Transações -->
    <div class="transactions-section">
        <div class="transactions-header">
            <h2 class="transactions-title">Abr/2023</h2>
        </div>

        <!-- Filtros -->
        <div class="filter-tabs">
            <button class="filter-tab active">Recebimentos</button>
            <button class="filter-tab">Despesas fixas</button>
            <button class="filter-tab">Despesas variáveis</button>
            <button class="filter-tab">Pessoas</button>
            <button class="filter-tab">Impostos</button>
            <button class="filter-tab">Transferências</button>
        </div>

        <!-- Tabela de Transações -->
        <table class="transactions-table">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Descrição</th>
                    <th>Recebido de</th>
                    <th>Categoria</th>
                    <th>Valor</th>
                    <th>Tipo pagamento</th>
                    <th>Pago?</th>
                </tr>
            </thead>
            <tbody>
                <tr class="transaction-row">
                    <td class="transaction-date">14/04/2023</td>
                    <td>
                        <div class="transaction-description">TED-TRANSF ELET DISPON REMET.BRASIL SOLUCO</div>
                    </td>
                    <td>BRASIL SOLUÇÕES</td>
                    <td class="transaction-category">Mensalidade</td>
                    <td class="transaction-value positive">R$20.000,00</td>
                    <td>
                        <span class="status-badge recorrente">1/12</span>
                        <div class="payment-type">Recorrente Mensal</div>
                    </td>
                    <td>✅</td>
                </tr>
                <tr class="transaction-row">
                    <td class="transaction-date">03/04/2023</td>
                    <td>
                        <div class="transaction-description">VISA CREDITO BRASIL SOLUÇÕES</div>
                    </td>
                    <td>BRASIL SOLUÇÕES</td>
                    <td class="transaction-category">Mensalidade</td>
                    <td class="transaction-value positive">R$10.342,29</td>
                    <td>
                        <span class="status-badge recorrente">1/12</span>
                        <div class="payment-type">Recorrente Mensal</div>
                    </td>
                    <td>✅</td>
                </tr>
                <tr class="transaction-row">
                    <td class="transaction-date">03/04/2023</td>
                    <td>
                        <div class="transaction-description">TED-TRANSF ELET DISPON REMET.BRASIL SOLUCO</div>
                    </td>
                    <td>BRASIL SOLUÇÕES</td>
                    <td class="transaction-category">Mensalidade</td>
                    <td class="transaction-value positive">R$23.543,00</td>
                    <td>
                        <span class="status-badge recorrente">1/12</span>
                        <div class="payment-type">Recorrente Mensal</div>
                    </td>
                    <td>✅</td>
                </tr>
                <tr class="transaction-row">
                    <td class="transaction-date">03/04/2023</td>
                    <td>
                        <div class="transaction-description">MASTER CREDITO BRASIL SOLUÇÕES</div>
                    </td>
                    <td>BRASIL SOLUÇÕES</td>
                    <td class="transaction-category">Mensalidade</td>
                    <td class="transaction-value positive">R$1.310,89</td>
                    <td>
                        <span class="status-badge recorrente">1/12</span>
                        <div class="payment-type">Recorrente Mensal</div>
                    </td>
                    <td>✅</td>
                </tr>
                <tr class="transaction-row">
                    <td class="transaction-date">03/04/2023</td>
                    <td>
                        <div class="transaction-description">VISA CREDITO BRASIL SOLUÇÕES</div>
                    </td>
                    <td>BRASIL SOLUÇÕES</td>
                    <td class="transaction-category">Mensalidade</td>
                    <td class="transaction-value positive">R$563,17</td>
                    <td>
                        <span class="status-badge recorrente">1/12</span>
                        <div class="payment-type">Recorrente Mensal</div>
                    </td>
                    <td>✅</td>
                </tr>
            </tbody>
        </table>

        <!-- Resumo Final -->
        <div class="summary-bottom">
            <div class="total-recebido">
                Recebido: R$58.074,49
            </div>
            <div class="total-a-receber">
                A Receber: R$0,00
            </div>
        </div>
    </div>
</div>


{% endblock %}
            </div>
